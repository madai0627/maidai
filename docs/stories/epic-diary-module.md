# æ—¥è®°æ¨¡å— - æ£•åœ°å¢å¼º Epic

> ğŸ“… åˆ›å»ºæ—¥æœŸ: 2024-12-17  
> ğŸ“‹ åˆ›å»ºè€…: John (PM)  
> ğŸ“Š çŠ¶æ€: âœ… Completed  
> ğŸ—ï¸ å…³è”æ¶æ„: [docs/architecture-diary.md](../architecture-diary.md)  
> ğŸ¨ å…³è”UIè§„æ ¼: [docs/front-end-spec-diary.md](../front-end-spec-diary.md)

---

## Epic æ¦‚è¿°

### Epic æ ‡é¢˜
**æ—¥è®°æ¨¡å— (Diary Module) - æ£•åœ°å¢å¼º**

### Epic ç›®æ ‡
ä¸º maidai ä¸ªäººç®¡ç†ç³»ç»Ÿæ–°å¢ç§å¯†æ—¥è®°åŠŸèƒ½ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿè®°å½•æ—¥å¸¸å¿ƒæƒ…å’Œæƒ³æ³•ï¼Œå¹¶é€šè¿‡æƒ…ç»ªç»Ÿè®¡å¯è§†åŒ–äº†è§£è‡ªå·±çš„æƒ…ç»ªå˜åŒ–è§„å¾‹ã€‚

### Epic ä»·å€¼
- ğŸ¯ **ç”¨æˆ·ä»·å€¼**: å¿«é€Ÿè®°å½•æ¯æ—¥å¿ƒæƒ…ï¼Œå›é¡¾æƒ…ç»ªå˜åŒ–
- ğŸ“Š **æ•°æ®ä»·å€¼**: æƒ…ç»ªåˆ†å¸ƒå¯è§†åŒ–ï¼Œæä¾›è‡ªæˆ‘æ´å¯Ÿ
- ğŸ”— **ç³»ç»Ÿä»·å€¼**: ä¸°å¯Œä¸ªäººç®¡ç†ç³»ç»ŸåŠŸèƒ½çŸ©é˜µ

---

## ç°æœ‰ç³»ç»Ÿä¸Šä¸‹æ–‡

### å½“å‰ç›¸å…³åŠŸèƒ½
- ç”¨æˆ·ç³»ç»Ÿ (usersè¡¨) - æä¾›user_idå…³è”
- ç…§ç‰‡å¢™æ¨¡å— - æä¾›å›¾ç‰‡Base64å­˜å‚¨æ¨¡å¼å‚è€ƒ
- è´¢åŠ¡æ¨¡å— - æä¾›åˆ—è¡¨åˆ†é¡µå’Œç»Ÿè®¡APIå‚è€ƒ
- é¦–é¡µä»ªè¡¨ç›˜ - EChartså›¾è¡¨ä½¿ç”¨å‚è€ƒ

### æŠ€æœ¯æ ˆ
| å±‚çº§ | æŠ€æœ¯ |
|------|------|
| **å‰ç«¯** | Vue 3 + Element Plus + ECharts + Axios |
| **åç«¯** | NestJS + TypeORM + MySQL |
| **å­˜å‚¨** | MySQL (madaiæ•°æ®åº“) |

### é›†æˆç‚¹
| ä½ç½® | é›†æˆæ–¹å¼ |
|------|---------|
| `backend/src/app.module.ts` | æ·»åŠ  DiaryModule åˆ° imports |
| `frontend/src/router.js` | æ·»åŠ  /index-diary è·¯ç”± |
| `frontend/src/api/index.js` | æ·»åŠ  7 ä¸ªæ—¥è®°APIå‡½æ•° |
| `frontend/src/views/Index.vue` | æ·»åŠ "å†™æ—¥è®°"å¿«æ·æŒ‰é’® |

---

## å¢å¼ºè¯¦æƒ…

### æ–°å¢å†…å®¹

**åç«¯æ¨¡å— (7ä¸ªæ–‡ä»¶)**
```
backend/src/diary/
â”œâ”€â”€ diary.module.ts
â”œâ”€â”€ diary.controller.ts
â”œâ”€â”€ diary.service.ts
â”œâ”€â”€ diary.entity.ts
â””â”€â”€ dto/
    â”œâ”€â”€ create-diary.dto.ts
    â”œâ”€â”€ update-diary.dto.ts
    â””â”€â”€ list-diary.dto.ts
```

**å‰ç«¯ç»„ä»¶ (9ä¸ªæ–‡ä»¶)**
```
frontend/src/
â”œâ”€â”€ views/diary/
â”‚   â”œâ”€â”€ Index.vue
â”‚   â””â”€â”€ components/
â”‚       â”œâ”€â”€ DiaryList.vue
â”‚       â”œâ”€â”€ DiaryEdit.vue
â”‚       â”œâ”€â”€ DiaryDetail.vue
â”‚       â””â”€â”€ DiaryStats.vue
â”œâ”€â”€ components/diary/
â”‚   â”œâ”€â”€ MoodSelector.vue
â”‚   â”œâ”€â”€ DiaryCard.vue
â”‚   â””â”€â”€ MoodChart.vue
â””â”€â”€ constants/diary.js
```

### é›†æˆæ–¹å¼
- **å¹¶è¡Œæ‰©å±•æ¨¡å¼**: ä¸ä¿®æ”¹ç°æœ‰æ¨¡å—æ ¸å¿ƒé€»è¾‘
- **åªè¿½åŠ ä»£ç **: ä¿®æ”¹çš„4ä¸ªæ–‡ä»¶å‡ä¸ºè¿½åŠ ï¼Œä¸æ”¹å·²æœ‰é€»è¾‘
- **å¤ç”¨ç°æœ‰æ¨¡å¼**: éµå¾ª photo_wallã€finance æ¨¡å—çš„è®¾è®¡æ¨¡å¼

### æˆåŠŸæ ‡å‡†
| ç»´åº¦ | æ ‡å‡† |
|------|------|
| **åŠŸèƒ½å®Œæ•´** | P0åŠŸèƒ½å…¨éƒ¨å®ç°ï¼Œæµç¨‹æ— é˜»æ–­ |
| **æ€§èƒ½è¾¾æ ‡** | åˆ—è¡¨åŠ è½½<2sï¼Œåˆ›å»º<1s |
| **ä»£ç è´¨é‡** | ç¬¦åˆç¼–ç è§„èŒƒï¼Œå…³é”®é€»è¾‘æœ‰æ³¨é‡Š |
| **å®‰å…¨è¾¾æ ‡** | æ•°æ®éš”ç¦»éªŒè¯ï¼Œè¾“å…¥éªŒè¯å®Œæ•´ |
| **å›å½’é€šè¿‡** | ç°æœ‰åŠŸèƒ½ä¸å—å½±å“ |

---

## Stories

### Story 1: åç«¯APIå¼€å‘
**æ ‡é¢˜**: æ—¥è®°æ¨¡å—åç«¯ - Entity + CRUD API + ç»Ÿè®¡æ¥å£

**èŒƒå›´**:
- åˆ›å»º Diary Entity å’Œæ•°æ®åº“è¡¨
- å®ç°æ—¥è®° CRUD API (å¢åˆ æ”¹æŸ¥)
- å®ç°æ—¥è®°åˆ—è¡¨åˆ†é¡µç­›é€‰
- å®ç°æƒ…ç»ªç»Ÿè®¡API
- å®ç°æ—¥å†æ•°æ®API

**é¢„ä¼°å·¥æ—¶**: 2-3å¤©

**å…³é”®éªŒæ”¶**:
- [ ] Diaryè¡¨è‡ªåŠ¨åˆ›å»ºæˆåŠŸ
- [ ] 7ä¸ªAPIç«¯ç‚¹å¯æ­£å¸¸è®¿é—®
- [ ] æ‰€æœ‰APIåŒ…å«user_idæ•°æ®éš”ç¦»
- [ ] å“åº”æ ¼å¼ç»Ÿä¸€ä¸º { code, msg, data }

---

### Story 2: å‰ç«¯é¡µé¢å¼€å‘
**æ ‡é¢˜**: æ—¥è®°æ¨¡å—å‰ç«¯ - ä¸»é¡µé¢ + åˆ—è¡¨ + ç¼–è¾‘å¼¹çª—

**èŒƒå›´**:
- åˆ›å»ºæ—¥è®°ä¸»é¡µé¢ (Index.vue)
- å®ç°æ—¥è®°åˆ—è¡¨ç»„ä»¶ (DiaryList.vue)
- å®ç°æ—¥è®°å¡ç‰‡ç»„ä»¶ (DiaryCard.vue)
- å®ç°æ—¥è®°ç¼–è¾‘å¼¹çª— (DiaryEdit.vue)
- å®ç°æƒ…ç»ªé€‰æ‹©å™¨ (MoodSelector.vue)
- æ·»åŠ è·¯ç”±å’ŒAPIå‡½æ•°

**é¢„ä¼°å·¥æ—¶**: 3-4å¤©

**å…³é”®éªŒæ”¶**:
- [ ] æ—¥è®°åˆ—è¡¨æ­£ç¡®å±•ç¤º
- [ ] åˆ›å»º/ç¼–è¾‘/åˆ é™¤æ—¥è®°åŠŸèƒ½æ­£å¸¸
- [ ] æƒ…ç»ªé€‰æ‹©å™¨äº¤äº’æµç•…
- [ ] å“åº”å¼å¸ƒå±€é€‚é…ç§»åŠ¨ç«¯

---

### Story 3: ç»Ÿè®¡åŠŸèƒ½ä¸è”è°ƒ
**æ ‡é¢˜**: æ—¥è®°æ¨¡å—ç»Ÿè®¡ - æƒ…ç»ªé¥¼å›¾ + åŠŸèƒ½è”è°ƒ + æµ‹è¯•

**èŒƒå›´**:
- å®ç°ç»Ÿè®¡é¢æ¿ (DiaryStats.vue)
- å®ç°æƒ…ç»ªé¥¼å›¾ (MoodChart.vue)
- å‰åç«¯åŠŸèƒ½è”è°ƒ
- é¦–é¡µæ·»åŠ "å†™æ—¥è®°"å¿«æ·å…¥å£
- åŠŸèƒ½æµ‹è¯•å’ŒBugä¿®å¤
- å›å½’æµ‹è¯•

**é¢„ä¼°å·¥æ—¶**: 2-3å¤©

**å…³é”®éªŒæ”¶**:
- [ ] æƒ…ç»ªé¥¼å›¾æ­£ç¡®æ˜¾ç¤ºåˆ†å¸ƒ
- [ ] ç‚¹å‡»å›¾è¡¨å¯ç­›é€‰æ—¥è®°
- [ ] é¦–é¡µå¿«æ·å…¥å£å¯ç”¨
- [ ] æ‰€æœ‰åŠŸèƒ½æµç¨‹æ— é˜»æ–­
- [ ] ç°æœ‰åŠŸèƒ½å›å½’é€šè¿‡

---

## å…¼å®¹æ€§è¦æ±‚

- [x] ç°æœ‰APIä¿æŒä¸å˜
- [x] æ•°æ®åº“å˜æ›´ä¸ºçº¯æ–°å¢ï¼ˆdiaryè¡¨ï¼‰
- [x] UIéµå¾ªElement Plusç°æœ‰æ ·å¼
- [x] æ€§èƒ½å½±å“å¯å¿½ç•¥

---

## é£é™©ç¼“è§£

### ä¸»è¦é£é™©
**é£é™©**: å›¾ç‰‡Base64å­˜å‚¨å¯èƒ½å¯¼è‡´æ•°æ®åº“è†¨èƒ€

**ç¼“è§£æªæ–½**: 
- å‰ç«¯å‹ç¼©å›¾ç‰‡è‡³500KBä»¥å†…
- é™åˆ¶å•ç¯‡æ—¥è®°æœ€å¤š9å¼ å›¾ç‰‡
- åç»­ç‰ˆæœ¬è€ƒè™‘è¿ç§»åˆ°æ–‡ä»¶å­˜å‚¨

### å›æ»šè®¡åˆ’
1. åˆ é™¤ `backend/src/diary/` ç›®å½•
2. ç§»é™¤ `app.module.ts` ä¸­çš„ DiaryModule
3. åˆ é™¤ `frontend/src/views/diary/` ç›®å½•
4. ç§»é™¤ `router.js` ä¸­çš„æ—¥è®°è·¯ç”±
5. ç§»é™¤ `api/index.js` ä¸­çš„æ—¥è®°APIå‡½æ•°
6. DROP TABLE diary

---

## Definition of Done

- [ ] æ‰€æœ‰ Story å®Œæˆä¸”éªŒæ”¶æ ‡å‡†è¾¾æˆ
- [ ] ç°æœ‰åŠŸèƒ½é€šè¿‡å›å½’æµ‹è¯•
- [ ] é›†æˆç‚¹å·¥ä½œæ­£å¸¸
- [ ] æ–‡æ¡£å·²æ›´æ–°
- [ ] æ— æ–°å¢å›å½’é—®é¢˜

---

## Story æ‰§è¡Œé¡ºåº

```
Story 1: åç«¯APIå¼€å‘
        â”‚
        â–¼
Story 2: å‰ç«¯é¡µé¢å¼€å‘
        â”‚
        â–¼
Story 3: ç»Ÿè®¡åŠŸèƒ½ä¸è”è°ƒ
        â”‚
        â–¼
    âœ… Epic å®Œæˆ
```

---

## é™„å½•

### æŠ€æœ¯å‚è€ƒ
| å‚è€ƒé¡¹ | å‚ç…§æ¨¡å— |
|-------|---------|
| åç«¯æ¨¡å—ç»“æ„ | `src/photo_wall/` |
| åˆ†é¡µåˆ—è¡¨API | `finance_record.service.ts` |
| ç»Ÿè®¡API | `quiz_record.service.ts` |
| å‰ç«¯é¡µé¢ç»“æ„ | `views/index-finance/Index.vue` |
| EChartsä½¿ç”¨ | `views/Index.vue` |

### ç›¸å…³æ–‡æ¡£
- [æ¶æ„æ–‡æ¡£](../architecture-diary.md)
- [UI/UXè§„æ ¼](../front-end-spec-diary.md)
- [AIæç¤ºè¯](../ai-prompts-diary.md)
- [éœ€æ±‚ç®€æŠ¥](../brief-diary.md)

---

*â€” End of Epic Document â€”*

